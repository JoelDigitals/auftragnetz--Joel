{% extends "base.html" %}
{% load i18n %}
{% block title %}{{ order.title }}{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
  <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
    <h2 class="text-2xl font-bold text-blue-600 dark:text-blue-400">{{ order.title }}</h2>
    <p class="mt-2 text-gray-600 dark:text-gray-400">
      {{ order.get_status_display }} â€¢ {{ order.created_at|date:"d.m.Y" }}
    </p>

    <p class="mt-4">{{ order.description|linebreaks }}</p>

    <div class="mt-4 grid grid-cols-2 gap-4 text-sm text-gray-500 dark:text-gray-400">
      <div><strong>{% if order.category.all %}
              {% for cat in order.category.all %}
                <span class="px-2 py-1 text-xs rounded-full bg-blue-100/70 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 shadow-sm">
                  {{ cat.name }}
                </span>
              {% endfor %}
            {% else %}
              <span class="px-2 py-1 text-xs rounded-full bg-gray-200/50 dark:bg-gray-700/50 text-gray-500 dark:text-gray-400">-</span>
            {% endif %}</div>
      <div><strong>{% trans "Budget" %}:</strong> {{ order.budget|default:"-" }}</div>
      <div><strong>{% trans "Deadline" %}:</strong> {{ order.deadline|default:"-" }}</div>
    </div>
  </div>

  <!-- Bewerbung -->
  {% if user.is_authenticated %}
  <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow mt-8">
    <h3 class="text-lg font-semibold mb-4">{% trans "Apply for this order" %}</h3>
    <form method="post" action="{% url 'apply_order' order.pk %}" class="space-y-4">
      {% csrf_token %}
      {{ app_form.as_p }}
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
        {% trans "Send application" %}
      </button>
    </form>
  </div>
  {% else %}
    <p class="mt-4 text-gray-600 dark:text-gray-400">
      <a href="{% url 'login' %}" class="text-blue-600 dark:text-blue-400 hover:underline">{% trans "Log in" %}</a>
      {% trans "to apply." %}
    </p>
  {% endif %}

  <!-- Bewerbungen -->
  <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow mt-8">
    <h3 class="text-lg font-semibold mb-4">{% trans "Applications" %}</h3>
    {% if applications %}
    <ul class="space-y-4">
      {% for app in applications %}
      <li class="border-b border-gray-200 dark:border-gray-700 pb-2">
        <strong>{{ app.applicant }}</strong>:
        <p class="mt-1">{{ app.message }}</p>
        <small class="text-gray-500 dark:text-gray-400">{{ app.created_at|date:"d.m.Y H:i" }}</small>
      </li>
      {% endfor %}
    </ul>
    {% else %}
      <p>{% trans "No applications yet." %}</p>
    {% endif %}
  </div>
</div>
{% endblock %}
